language: php
php:
  - '7.0'

git:
  depth: false

services:
  - docker

sudo: required

env:
  - DOCKER_COMPOSE_VERSION=1.24

before_install:
  - cp .env.dist .env

install:
  - docker-compose up -d --build
  - docker exec -it mirrors_php_1 php composer.phar install
  - docker exec -it mirrors_php_1 vendor/bin/phinx migrate

script:
  - docker exec -it mirrors_behat_1 vendor/bin/behat

after_script:
  - docker-compose stop
  - docker-compose rm -f
